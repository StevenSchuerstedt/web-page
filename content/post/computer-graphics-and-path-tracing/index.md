---
title: StevieTrace - Computer Graphics and Path Tracing
author: admin
type: page
date: 2020-10-13T08:12:42+00:00
featured_image: "stevieTrace.png"

---
 



In computer graphics there exist two big categories that use a different approach to render an image to the display. These are online- and offline or realtime- and no realtime rendering. In computer games, or any other interactive media the computer needs to respond to the input of the user in a short amount of time to give the illusion of a continous media experience. Frames need to be rendered at about 60 times per second, so the time spent for one frame is very little. On the other hand for non interactive media, like movies or pictures, the time spent to calculate one frame is not restricted. This gives a different approach for rendering images. In realtime rendering, all rendering happens on the graphics card, the GPU. The GPU is a highly parallelized computer, that can run a lot of programs at once. This is used to calculate the color for every pixel on the monitor simultaneously. In order to program on the GPU there exists several API&#8217;s (like OpenGL, Vulkan, DirectX..) to communicate with the GPU. These API&#8217;s offer the ability to write shaders, which are programs that are executed on the GPU (see [StevieJump][1], for an application with OpenGL). 

For offline rendering a algorithm called raytracing is used. This algorithm tries to mimic the way light waves/particles behave when the illuminate a scene. A light ray gets projected into a scene from a lightsource and gets reflected, absorbed or scattered by interacting with surfaces or volume media. The basis for offline rendering are the physics laws that describe the behaviour of light (like Maxwell&#8217;s formulas). Many popular ray tracer run on the CPU. The difference between offline- and online rendering is getting smaller as time progresses. The computing power of modern computers is advancing, so the complicated algorithms of offline rendering become more and more feasible to use in real time (see real time ray tracing).

## Path tracing and StevieTracer

The basis equation for offline rendering is the rendering equation (the brackets behind the equation denote the unit)

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-3076ab2f6315d49a9b615bfeb01d8a66_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#61;&#32;&#76;&#95;&#101;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#43;&#32;&#92;&#105;&#110;&#116;&#95;&#123;&#83;&#94;&#50;&#125;&#32;&#92;&#102;&#95;&#114;&#40;&#92;&#111;&#109;&#101;&#103;&#97;&#44;&#32;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#32;&#92;&#118;&#101;&#114;&#116;&#32;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#110;&#125;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#32;&#92;&#99;&#100;&#111;&#116;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#32;&#92;&#118;&#101;&#114;&#116;&#32;&#100;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;" title="Rendered by QuickLaTeX.com" height="20" width="429" style="vertical-align: -6px;" /><img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-0f3af2534b71517be958402fc1e5b578_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#91;&#92;&#102;&#114;&#97;&#99;&#123;&#87;&#125;&#123;&#109;&#94;&#50;&#115;&#114;&#125;&#93;" title="Rendered by QuickLaTeX.com" height="23" width="42" style="vertical-align: -7px;" /> 



This equation describes the behaviour of light on surface in a vacuum. The term<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-fdd7c23e32c6e708900c570a7e10a497_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;" title="Rendered by QuickLaTeX.com" height="19" width="55" style="vertical-align: -5px;" /> describes the radiance flowing from a point<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-27a2f7ab513a764b16fc08c9df21cf7a_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;" /> in the direction<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-707fcec15e450815730425a6607a1858_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#111;&#109;&#101;&#103;&#97;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;" /> . This radiance is a combination of the direct light, being emitted from the point itself, and the indirect radiance from all other directions. Radiance is power per square meter per solid angle.

Solving this equation directly is very difficult because we cannot compute the integral and there is also a recursion inside the equation, because the term<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-fdd7c23e32c6e708900c570a7e10a497_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;" title="Rendered by QuickLaTeX.com" height="19" width="55" style="vertical-align: -5px;" /> appears on bot sides. For integration we use a technique called monte-carlo integration. For the recursion we use the ray tracing algorithm. 

A monte-carlo estimator for some generic function<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-a7ee323bc5a3f73ad5e066b13bed5504_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#40;&#120;&#41;" title="Rendered by QuickLaTeX.com" height="19" width="34" style="vertical-align: -5px;" /> is given by

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-6575370ca5e05080c9170bbc5678a04a_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#105;&#110;&#116;&#32;&#102;&#40;&#120;&#41;&#100;&#120;&#32;&#61;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#49;&#125;&#123;&#78;&#125;&#92;&#115;&#117;&#109;&#95;&#123;&#105;&#61;&#49;&#125;&#94;&#123;&#78;&#125;&#92;&#102;&#114;&#97;&#99;&#123;&#102;&#40;&#88;&#95;&#105;&#41;&#125;&#123;&#112;&#40;&#88;&#95;&#105;&#41;&#125;" title="Rendered by QuickLaTeX.com" height="29" width="194" style="vertical-align: -10px;" /> 

To evaluate the integral we evaluate the function at random points<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-998dba373bb08119e12a646c873be88c_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#88;&#95;&#105;" title="Rendered by QuickLaTeX.com" height="15" width="20" style="vertical-align: -3px;" /> , that are distributed according to the probability density function<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-a56ad4bfa5995a614f176b4f5d91b2a1_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#112;&#40;&#88;&#95;&#105;&#41;" title="Rendered by QuickLaTeX.com" height="19" width="43" style="vertical-align: -5px;" /> (pdf). This pdf can be everything we want, since the function actually has no propabilites relate to it, but in order to have a fast convergence to the correct result it is best to choose the pdf similar to<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-a7ee323bc5a3f73ad5e066b13bed5504_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#40;&#120;&#41;" title="Rendered by QuickLaTeX.com" height="19" width="34" style="vertical-align: -5px;" /> .

In order to use the rendering equation for actual images, we need to relate it to the final pixel color of a monitor. This is done by using a Neumann-Reihe. If the rendering equation is written in operator notation one can see that it is actually a geometric series. This can be written as an infinite sum and finally an integral over the pathspace, a space that includes all possible combinations of paths. Also we switch the integration domain from directions to surfaces, to be able to sample points on lightsources. 

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-4f67ab8101e7de320adcdc737f38dd48_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#73;&#32;&#61;&#32;&#92;&#105;&#110;&#116;&#95;&#80;&#32;&#102;&#40;&#88;&#41;&#100;&#88;" title="Rendered by QuickLaTeX.com" height="20" width="121" style="vertical-align: -6px;" /><img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-90b0c2bd56aedad2c43738fafd5af044_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#91;&#87;&#93;" title="Rendered by QuickLaTeX.com" height="18" width="25" style="vertical-align: -5px;" /> 

This function sums up the contribution of all possible paths weighted with the measurement contribution function (MCF). The MCF calculates the contribution of a complete path from lightsource to the camera, along<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-3422b6bb5c160593658b7c39425d9880_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#107;" title="Rendered by QuickLaTeX.com" height="12" width="9" style="vertical-align: 0px;" /> vertices. 

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-7284b36d1d550e3d266f199c26ba62b0_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#40;&#88;&#41;&#32;&#61;&#32;&#76;&#95;&#101;&#32;&#71;&#40;&#120;&#95;&#123;&#107;&#45;&#49;&#125;&#44;&#32;&#120;&#95;&#107;&#41;&#32;&#40;&#92;&#112;&#114;&#111;&#100;&#95;&#123;&#105;&#61;&#50;&#125;&#94;&#123;&#107;&#45;&#49;&#125;&#102;&#95;&#114;&#40;&#120;&#95;&#105;&#41;&#71;&#40;&#120;&#95;&#123;&#105;&#45;&#49;&#125;&#44;&#120;&#95;&#105;&#41;&#41;&#87;" title="Rendered by QuickLaTeX.com" height="22" width="382" style="vertical-align: -5px;" /> 

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-30a79c32f18567063fe44716929e7ced_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#71;" title="Rendered by QuickLaTeX.com" height="12" width="14" style="vertical-align: 0px;" /> is the geometry term and relates solid angle to vertex area. It is needed to switch the integration domain from directions to surfaces and is the jacobian of that coordinate transformation. 

To use monte carlo integration on the path space integral we need a way to sample paths and determine the pdf with it. One approach is to sample a direction according to the BRDF, so we choose a new direction that would give a high contribution according to the BRDF. Because this pdf would then be in solid angle measure, we also need to convert it with the geometry term to vertex area measure. Effectively the geometry term will cancel out in the estimator. In order to guarantee to hit the lightsource we use an algorithm called next event estimation (NEE). After we have an intersection with scene geometry, we will automatically sample a point on the lightsource and try to build a connection. Therefore we need to evaluate the visibility function, to check if the sampled point on the light source is actually visible from the vertex. 

Finally our monte carlo estimate of the pixel intensity is

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-b89765fe78353f7b1bab60733858236a_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#102;&#114;&#97;&#99;&#123;&#49;&#125;&#123;&#78;&#125;&#92;&#115;&#117;&#109;&#95;&#123;&#105;&#61;&#49;&#125;&#94;&#123;&#78;&#125;&#92;&#102;&#114;&#97;&#99;&#123;&#76;&#95;&#101;&#40;&#120;&#95;&#107;&#41;&#32;&#71;&#40;&#120;&#95;&#123;&#107;&#45;&#49;&#125;&#44;&#32;&#120;&#95;&#107;&#41;&#32;&#92;&#112;&#114;&#111;&#100;&#95;&#123;&#105;&#61;&#50;&#125;&#94;&#123;&#107;&#45;&#49;&#125;&#102;&#95;&#114;&#40;&#120;&#95;&#105;&#41;&#125;&#123;&#112;&#40;&#120;&#95;&#107;&#41;&#32;&#92;&#112;&#114;&#111;&#100;&#95;&#123;&#105;&#61;&#50;&#125;&#94;&#123;&#107;&#45;&#49;&#125;&#32;&#112;&#40;&#92;&#111;&#109;&#101;&#103;&#97;&#95;&#105;&#41;&#125;" title="Rendered by QuickLaTeX.com" height="36" width="254" style="vertical-align: -13px;" /> 

This are roughly the basic mathematics and thoughts that go into writing a path tracer. I tried to write a simple as possible version of a path tracer, called stevieTracer. It is based on &#8220;ray tracing in one weekend&#8221; by Peter Shirley and is upgraded to support all the things described above. 

## StevieTracer

StevieTracer is a simple path tracer I wrote after a university course about photorealistic rendering. 

Overview:

  * StevieTracer uses the ppm image format, because it is so easy
  * only supports rendering of spheres, but by using very big spheres the illusion of a wall can be achieved
  * supports a perfectly specular and a perfectly diffuse material
  * next event estimation
  * Russian roulette to terminate paths

**lambertian brdf:**

The lambertian brdf is a perfectly diffuse brdf, this means light is scattered in all directions equally. 

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-1bc559ee1ffa68aa11514af1598871c4_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#102;&#95;&#114;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#32;&#61;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#92;&#114;&#104;&#111;&#125;&#123;&#92;&#112;&#105;&#125;" title="Rendered by QuickLaTeX.com" height="20" width="75" style="vertical-align: -6px;" /> 

Note the brdf does not depend on any direction.<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-da039068127cf2ec5fc05123d4d3546f_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#114;&#104;&#111;" title="Rendered by QuickLaTeX.com" height="12" width="9" style="vertical-align: -4px;" /> is the albedo of the surfacepoint<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-27a2f7ab513a764b16fc08c9df21cf7a_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;" /> (the color of the object) and<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-26d6788550ffd50fe94542bb3e8ee615_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#92;&#112;&#105;" title="Rendered by QuickLaTeX.com" height="8" width="11" style="vertical-align: 0px;" /> is needed for energy conservation. Because the probability of every direction is the same, the pdf for this brdf simply is the probability of sampling a direction in the sphere.

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-e10e2f7502ed994d46b3b8386764ba44_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#112;&#32;&#61;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#49;&#125;&#123;&#52;&#92;&#112;&#105;&#125;" title="Rendered by QuickLaTeX.com" height="22" width="51" style="vertical-align: -6px;" /> 

In this case it would be better to sample the cosine term in the rendering equation and change the sampling procedure and the pdf accordingly. 

**metal brdf:**

The metal brdf is a perfectly specular material, like a really shiny metal or a mirror. This means for every incoming direction, there is only one outgoing direction to transport energy. Mathematically this is achieved by using a delta function for the brdf, so in the rendering equation the integral only gets evaluated for one single direction. In code this direction can only be sampled, so the brdf should never be evaluated for any other direction. <figure class="wp-block-image size-large">

<img loading="lazy" width="500" height="281" src="https://steven.schuerstedt.com/wp-content/uploads/2021/05/render2.png" alt="" class="wp-image-1093" srcset="https://steven.schuerstedt.com/wp-content/uploads/2021/05/render2.png 500w, https://steven.schuerstedt.com/wp-content/uploads/2021/05/render2-300x169.png 300w" sizes="(max-width: 500px) 100vw, 500px" /> </figure> 

## Volume Rendering

In volume rendering a vacuum is no longer assumed, and there exists different processes inside a medium, like absorption or scattering, that affect photons. These things are modeled stochastically with different emission, absorption and scattering coefficients. 

The basis equation for volume rendering is the volume rendering equation. It is derived by integrating the radiance transfer equation and using surfaces as a boundary condition. 

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-00f32823ba9c8bc2042c265cf2e0e7b8_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#61;&#32;&#92;&#105;&#110;&#116;&#95;&#123;&#48;&#125;&#94;&#123;&#122;&#125;&#32;&#84;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#121;&#125;&#41;&#32;&#92;&#115;&#105;&#103;&#109;&#97;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#121;&#125;&#41;&#76;&#94;&#109;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#121;&#125;&#44;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#100;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#121;&#125;&#43;&#84;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#41;&#76;&#94;&#83;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#44;&#92;&#111;&#109;&#101;&#103;&#97;&#41;" title="Rendered by QuickLaTeX.com" height="21" width="422" style="vertical-align: -6px;" /> 

with

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-51999859a0bfa2b5cc56d9ce3641a59c_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#94;&#83;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#61;&#32;&#76;&#95;&#101;&#94;&#83;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#43;&#32;&#92;&#105;&#110;&#116;&#95;&#123;&#83;&#94;&#50;&#125;&#32;&#92;&#114;&#104;&#111;&#95;&#83;&#40;&#92;&#111;&#109;&#101;&#103;&#97;&#44;&#32;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#44;&#32;&#45;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#32;&#92;&#118;&#101;&#114;&#116;&#32;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#110;&#125;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#122;&#125;&#41;&#32;&#92;&#99;&#100;&#111;&#116;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#32;&#92;&#118;&#101;&#114;&#116;&#32;&#100;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;" title="Rendered by QuickLaTeX.com" height="21" width="458" style="vertical-align: -6px;" /> 

for vertices on the surface and

<img loading="lazy" src="https://steven.schuerstedt.com/wp-content/ql-cache/quicklatex.com-26a8b9e6fb1afe9bebe3cb63563d1e0d_l3.png" class="ql-img-inline-formula quicklatex-auto-format" alt="&#76;&#94;&#109;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#61;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#92;&#115;&#105;&#103;&#109;&#97;&#32;&#95;&#97;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#125;&#123;&#92;&#115;&#105;&#103;&#109;&#97;&#32;&#95;&#116;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#125;&#76;&#95;&#101;&#94;&#109;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#41;&#32;&#43;&#32;&#92;&#102;&#114;&#97;&#99;&#123;&#92;&#115;&#105;&#103;&#109;&#97;&#32;&#95;&#115;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#125;&#123;&#92;&#115;&#105;&#103;&#109;&#97;&#32;&#95;&#116;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#41;&#125;&#32;&#92;&#105;&#110;&#116;&#95;&#123;&#83;&#94;&#50;&#125;&#32;&#92;&#114;&#104;&#111;&#95;&#109;&#40;&#92;&#111;&#109;&#101;&#103;&#97;&#44;&#32;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#76;&#40;&#92;&#116;&#101;&#120;&#116;&#98;&#102;&#123;&#120;&#125;&#44;&#32;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;&#41;&#100;&#92;&#111;&#109;&#101;&#103;&#97;&#94;&#92;&#112;&#114;&#105;&#109;&#101;" title="Rendered by QuickLaTeX.com" height="29" width="466" style="vertical-align: -9px;" /> 

for points inside the medium. 

In heterogenous media it is very difficult to sample distances and evaluate the transmittance term T(\textbf{x},\textbf{y}), because of the integral in the exponent. In order to simplify the medium the null-scattering algorithm is used. The heterogenous medium gets filled up with fictous particles, until a constant density is reached. Sampling from this homogenous medium with the null-scattering particles is now possible with a rejection sampling method. But by doing so the pdf for the sample is lost. This is no problem in the normal case, because the pdf with the transmittance will cancel out anyways, but using multiple importance sampling is no longer possible. In the paper &#8220;a null-scattering path integral formulation of light tranpsort&#8221; written by Bailey Miller, Iliyan Georgiev and Wojciech Jarosz, they describe a way to shift the entire rendering procedure into a null-scattering environment, which allows them to calculate the pdf and use MIS.

<div class="wp-block-file">
  <a href="https://steven.schuerstedt.com/wp-content/uploads/2020/10/schuerstedt.pdf">For a more detailed discussion about the priniciples of volume rendering and the null-scattering approach, see my seminararbeit about the topic</a><a href="https://steven.schuerstedt.com/wp-content/uploads/2020/10/schuerstedt.pdf" class="wp-block-file__button" download>Download</a>
</div>

 [1]: https://steven.schuerstedt.com/?page_id=343